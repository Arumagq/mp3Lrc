!function(a){a.extend({getParseLrc:function(b,c){a.ajax({url:b,type:"get",dataType:"text"}).done(function(a){var b=a.match(/\[[^\r\n]+\r\n/gm);if(!b)throw new Error("the request file is not a lyric file");var d,e={content:[]};b.forEach(function(a){(d=a.match(/^\[([^0-9:]+):([^\]]+)\]/))?e[d[1]]=d[2]:(d=a.match(/^\[(\d+):(\d+)\.(\d+)\]([^\r\n]+)\r\n/))&&e.content.push({startTime:60*Number(d[1])+Number(d[2])+.01*Number(d[3]),content:d[4]})}),e.content.sort(function(a,b){return a.startTime>b.startTime?1:-1}),e.content.forEach(function(a,b){b<e.content.length-1?a.time=e.content[b+1].startTime-a.startTime:a.time=null}),c(e)})}})}(jQuery),function(a){a.fn.extend({constructLrc:function(b,c){b=a.extend({classUl:"",classLi:"",classLiActive:"",scrollTime:300},b);var d=a("<ul>").addClass(b.classUl).appendTo(this);c.forEach(function(c){a("<li>").addClass(b.classLi).data({time:c.time,startTime:c.startTime}).text(c.content).appendTo(d)});for(var e,f=d.children(),g=f.first(),h=g.height(),i=Math.round(d.height()/h/2),j=0,k=!1,l=0;i>l;l++)a("<li>").addClass(b.classLi).data({time:0,startTime:0}).prependTo(d),a("<li>").addClass(b.classLi).data({time:0,startTime:0}).appendTo(d);f=d.children();var m=a(this),n=function(a,c){switch(f.filter("."+b.classLiActive).removeClass(b.classLiActive),clearTimeout(j),j=setTimeout(function(){f.eq(a).removeClass(b.classLiActive),o(++a)},c),f.eq(a).addClass(b.classLiActive),a){case i-1:m.trigger("begin");break;case f.length-i:m.trigger("end");break;default:m.trigger("scrollTime",[f.eq(a).data("startTime")])}e=a},o=function(a){i-1>a||a>f.length-i||d.stop().animate({scrollTop:(a-i+1)*h},b.scrollTime,function(){n(a,1e3*f.eq(a).data("time")-b.scrollTime)})};return o(i-1),d.mousewheel(function(a){k||(k=!0,m.trigger("scrollBegin")),a.stopPropagation(),a.preventDefault(),e==i-1&&1==a.deltaY||e==f.length-i&&-1==a.deltaY||(f.eq(e).removeClass(b.classLiActive),1==a.deltaY?e--:e++,d.scrollTop((e-i+1)*h),f.eq(e).addClass(b.classLiActive),clearTimeout(j),j=setTimeout(function(){m.trigger("scrollEnd"),k=!1,o(e)},500))}),a(this)}})}(jQuery),function(a){a.fn.extend({lrc:function(b,c){if(b=a.extend({classUl:"",classLi:"",classLiActive:"",scrollTime:300,url:""},b),!b.url)throw new Error("please input lyric url in your option");var d=a(this);a.getParseLrc(b.url,function(a){d.constructLrc(b,a.content),c&&"function"==typeof c&&c(a)})}})}(jQuery);