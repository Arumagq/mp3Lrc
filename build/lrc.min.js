!function(a){a.extend({getParseLrc:function(b,c){a.ajax({url:b,type:"get",dataType:"text"}).done(function(a){var b=a.match(/\[[^\r\n]+\r\n/gm);if(!b)throw new Error("the request file is not a lyric file");var d,e={content:[]};b.forEach(function(a){(d=a.match(/^\[([^0-9:]+):([^\]]+)\]/))?e[d[1]]=d[2]:(d=a.match(/^\[(\d+):(\d+)\.(\d+)\]([^\r\n]+)\r\n/))&&e.content.push({startTime:60*Number(d[1])+Number(d[2])+.01*Number(d[3]),content:d[4]})}),e.content.sort(function(a,b){return a.startTime>b.startTime?1:-1}),e.content.forEach(function(a,b){b<e.content.length-1?a.time=e.content[b+1].startTime-a.startTime:a.time=0}),c(e)})}})}(jQuery),function(a){a.fn.extend({constructLrc:function(b,c){b=a.extend({classUl:"",classLi:"",classLiActive:"",scrollTime:300,infoBegin:"begin",infoEnd:"end",isAutoBegin:!0},b);var d=a("<ul>").addClass(b.classUl).appendTo(this);c.forEach(function(c){a("<li>").addClass(b.classLi).data({time:c.time,startTime:c.startTime}).text(c.content).appendTo(d)});for(var e=d.children(),f=e.first(),g=f.height(),h=Math.round(d.height()/g/2),i=0,j={current:0,index:h-1},k=(new Date).getTime(),l=!1,m=!0,n=0;h>n;n++)a("<li>").text(0==n?b.infoBegin:"").addClass(b.classLi).data({time:0==n?c[0].startTime:0,startTime:0}).prependTo(d),a("<li>").text(0==n?b.infoEnd:"").addClass(b.classLi).data({time:0,startTime:c[c.length-1].startTime}).appendTo(d);e=d.children();var o=a(this),p=function(a,c){void 0==a&&(a=j.index),void 0==c&&(c=j.current);var f=e.eq(a).data("time");clearTimeout(i),d.stop(),i=setTimeout(function(){j.index++,j.current=0,k=(new Date).getTime(),q()},1e3*(f-c)),e.filter("."+b.classLiActive).removeClass(b.classLiActive),e.eq(a).addClass(b.classLiActive),a==h-1&&0==c?o.trigger("begin"):a==e.length-h&&0==c&&o.trigger("end")},q=function(a){void 0==a&&(a=j.index),h-1>a||a>e.length-h||(a==h-1?o.trigger("begin"):a==e.length-h&&o.trigger("end"),d.stop().animate({scrollTop:(a-h+1)*g},b.scrollTime,function(){p(a,b.scrollTime/1e3)}))},r=function(a){void 0==a&&(a=j.index),clearTimeout(i),d.stop().scrollTop((a-h+1)*g),e.filter("."+b.classLiActive).removeClass(b.classLiActive),e.eq(a).addClass(b.classLiActive)};return d.mousewheel(function(a){a.stopPropagation(),a.preventDefault(),j.index<=h-1&&1==a.deltaY||j.index>=e.length-h&&-1==a.deltaY||(l||(l=!0,o.trigger("scrollBegin")),1==a.deltaY?j.index--:j.index++,r(),i=setTimeout(function(){o.trigger("scrollEnd",[e.eq(j.index).data("startTime")]),l=!1,k=(new Date).getTime(),m||p()},500))}),b.isAutoBegin&&(m=!1,q(h-1)),{pause:function(){m||(clearTimeout(i),d.stop(),j.current+=((new Date).getTime()-k)/1e3,k=(new Date).getTime(),m=!0)},goOn:function(){m&&(p(),m=!1)},getProcess:function(){if(!m){var a=(new Date).getTime();j.current+=(a-k)/1e3,k=a}return e.eq(j.index).data("startTime")+j.current},setProcess:function(b){var c=-1;return e.each(function(d,e){return a(e).data("startTime")<=b&&a(e).data("startTime")+a(e).data("time")>b?(c=d,!1):void 0}),-1==c?!1:(j.index=c,j.current=b-e.eq(c).data("startTime"),k=(new Date).getTime(),r(),m||p(),!0)}}}})}(jQuery),function(a){a.fn.extend({lrc:function(b,c){if(b=a.extend({classUl:"",classLi:"",classLiActive:"",scrollTime:300,url:""},b),!b.url)throw new Error("please input lyric url in your option");var d=a(this);a.getParseLrc(b.url,function(a){var e=d.constructLrc(b,a.content);c&&"function"==typeof c&&c(e)})}})}(jQuery);